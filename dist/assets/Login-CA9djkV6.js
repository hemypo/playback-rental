import{A as E,B as I,aD as T,r as i,j as s,a as D,T as H,U as V,V as B,W as Q,bQ as h,aQ as j,a1 as p,a2 as f,I as g,a3 as R,bR as k}from"./index-CKzDOQbx.js";import{z as n,u as z,e as M,a as b,b as N,F as v,c as y,d as F,t as U}from"./index-DSv7xXBc.js";const W=n.object({email:n.string().email({message:"Введите корректный email"}),password:n.string().min(1,{message:"Пароль обязателен"})}),J=()=>{var x,u;const w=E(),C=I(),{toast:t}=T(),[o,c]=i.useState(!1),[m,S]=i.useState(!1),[d,l]=i.useState(null),L=((u=(x=C.state)==null?void 0:x.from)==null?void 0:u.pathname)||"/admin",r=z({resolver:U(W),defaultValues:{email:"",password:""}}),A=async e=>{c(!0),l(null);try{const a=await k(e.email,e.password);a.success?(t({title:"Вход выполнен успешно",description:"Добро пожаловать в админ-панель."}),w(L,{replace:!0})):(l(a.error||"Неверный email или пароль. Пожалуйста, попробуйте снова."),t({variant:"destructive",title:"Ошибка входа",description:a.error||"Неверный email или пароль. Пожалуйста, попробуйте снова."}))}catch(a){l(a.message||"Произошла ошибка при попытке входа."),t({variant:"destructive",title:"Ошибка входа",description:a.message||"Произошла ошибка при попытке входа."})}finally{c(!1)}};return s.jsx("div",{className:"flex items-center justify-center min-h-[calc(100vh-64px)]",children:s.jsxs(D,{className:"w-full max-w-md",children:[s.jsxs(H,{className:"space-y-1",children:[s.jsx(V,{className:"text-2xl font-bold",children:"Вход в систему"}),s.jsx(B,{children:"Введите ваши учетные данные для доступа к админ-панели"})]}),s.jsxs(Q,{children:[d&&s.jsxs(h,{variant:"destructive",className:"mb-4",children:[s.jsx(j,{children:"Ошибка входа"}),s.jsx(p,{children:d})]}),s.jsx(M,{...r,children:s.jsxs("form",{onSubmit:r.handleSubmit(A),className:"space-y-4",children:[s.jsx(b,{control:r.control,name:"email",render:({field:e})=>s.jsxs(N,{children:[s.jsx(v,{children:"Email"}),s.jsx(y,{children:s.jsx(f,{placeholder:"your@email.com",...e})}),s.jsx(F,{})]})}),s.jsx(b,{control:r.control,name:"password",render:({field:e})=>s.jsxs(N,{children:[s.jsx(v,{children:"Пароль"}),s.jsx(y,{children:s.jsx(f,{type:"password",placeholder:"••••••••",...e})}),s.jsx(F,{})]})}),s.jsx(g,{type:"submit",className:"w-full",disabled:o,children:o?"Выполняется вход...":"Войти"})]})})]}),s.jsxs(R,{className:"flex flex-col",children:[s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Используйте email и пароль зарегистрированные в Supabase Auth"}),s.jsx(g,{variant:"ghost",className:"text-sm text-muted-foreground mt-2",onClick:()=>S(!m),children:"Нужна помощь?"}),m&&s.jsxs(h,{variant:"info",className:"mt-3",children:[s.jsx(j,{children:"Информация об авторизации"}),s.jsxs(p,{children:[s.jsx("p",{className:"mb-2",children:"Для входа требуется:"}),s.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[s.jsx("li",{children:"Аккаунт в Supabase Authentication"}),s.jsx("li",{children:"Введите ваш email и пароль для входа"})]})]})]})]})]})})};export{J as default};
